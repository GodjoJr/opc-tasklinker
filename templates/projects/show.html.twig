{% extends 'base.html.twig' %}

{% block custom_title %}
	<div class="flex-header">
		<h1>
			{{ project.title }}
		</h1>
		<div class="user-list">
			{% for member in project.members %}
				{% set initials = member.firstname|first ~ member.lastname|first %}
				<div class="avatar" title="{{ member.firstname }} {{ member.lastname }}">
					{{ initials|upper }}
				</div>
			{% endfor %}
		</div>
		<a class="button" href="{{ path('app_projects_edit', { id: project.id}) }}">Modifier</a>
	</div>

{% endblock %}

{% block body %}

	<div id="content">
		<div id="tasks-container">

			{% if(tasks['todo'] is defined) %}
				<div class="task-column">

					<h2>To Do</h2>

					<div class="tasks-list">

						{% for task in tasks['todo'] %}
							<a class="task" href="{{ path('app_tasks_edit', { id: task.id}) }}">
								<h3>{{ task.title }}</h3>
								<p>{{ task.description }}</p>
								<div class="task-infos">
									<div class="task-deadline">
										<i class="fa-regular fa-calendar"></i>
										{{ task.date|date('d/m/Y') }}
										{% for member in task.members %}
											{% set initials = member.firstname|first ~ member.lastname|first %}
											<div class="mini-user" title="{{ member.firstname }} {{ member.lastname }}">
												{{ initials|upper }}
											</div>
										{% endfor %}
									</div>
								</div>
							</a>
						{% endfor %}

						<a href="{{ path('app_tasks_add', { id: project.id}) }}" class="task-add">
							+ Ajouter une tâche
						</a>

					</div>

				</div>
			{% endif %}

			{% if(tasks['doing'] is defined) %}
				<div class="task-column">

					<h2>Doing</h2>

					<div class="tasks-list">

						{% for task in tasks['doing'] %}
							<a class="task" href="{{ path('app_tasks_edit', { id: task.id}) }}">
								<h3>{{ task.title }}</h3>
								<p>{{ task.description }}</p>
								<div class="task-infos">
									<div class="task-deadline">
										<i class="fa-regular fa-calendar"></i>
										{{ task.date|date('d/m/Y') }}
										{% for member in task.members %}
											{% set initials = member.firstname|first ~ member.lastname|first %}
											<div class="mini-user" title="{{ member.firstname }} {{ member.lastname }}">
												{{ initials|upper }}
											</div>
										{% endfor %}
									</div>
								</div>
							</a>
						{% endfor %}

						<a href="{{ path('app_tasks_add', { id: project.id}) }}" class="task-add">
							+ Ajouter une tâche
						</a>

					</div>

				</div>
			{% endif %}

			{% if(tasks['done'] is defined) %}
				<div class="task-column">

					<h2>Done</h2>

					<div class="tasks-list">

						{% for task in tasks['done'] %}
							<a class="task" href="{{ path('app_tasks_edit', { id: task.id}) }}">
								<h3>{{ task.title }}</h3>
								<p>{{ task.description }}</p>
								<div class="task-infos">
									<div class="task-deadline">
										<i class="fa-regular fa-calendar"></i>
										{{ task.date|date('d/m/Y') }}
										{% for member in task.members %}
											{% set initials = member.firstname|first ~ member.lastname|first %}
											<div class="mini-user" title="{{ member.firstname }} {{ member.lastname }}">
												{{ initials|upper }}
											</div>
										{% endfor %}
									</div>
								</div>
							</a>
						{% endfor %}

						<a href="{{ path('app_tasks_add', { id: project.id}) }}" class="task-add">
							+ Ajouter une tâche
						</a>

					</div>

				</div>
			{% endif %}

		</div>
	</div>

{% endblock %}
